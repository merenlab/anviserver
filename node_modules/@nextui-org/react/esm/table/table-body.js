import l,{useMemo as e}from"react";import{mergeProps as o}from"@react-aria/utils";import{Loading as t}from"../index";import r from"../utils/clsx";import{StyledBaseTableCell as i,StyledTableLoadingRow as n}from"./table.styles";import a from"./table-row-group";import s from"./table-row";import c from"./table-cell";import d from"./table-checkbox-cell";import{useTableContext as u}from"./table-context";import{isInfinityScroll as m}from"./utils";import{jsx as p}from"react/jsx-runtime";import{jsxs as h}from"react/jsx-runtime";const b=({children:b,collection:y,state:f,animated:g,color:x,hasPagination:v,hideLoading:S,isStatic:N,...w})=>{var C,j,k,E,H,P;const{currentPage:B,rowsPerPage:L,collection:M,setCollection:A}=u(),I=e((()=>m(y)),[y.body.props]);l.useEffect((()=>{y!==M&&(null==A||A(y))}),[y,M]);const T="loading"===(null==(C=y.body)||null==(j=C.props)?void 0:j.loadingState)||"loadingMore"===(null==(k=y.body)||null==(E=k.props)?void 0:E.loadingState),U=e((()=>{const l=[...y.body.childNodes];return v?null==l?void 0:l.slice((B-1)*L,B*L):l}),[v,y,B,L]),$=e((()=>{const l=U.length;return l>=L&&!I?null:p("tr",{"aria-hidden":"true",className:"nextui-table-hidden-row",role:"row",children:p(i,{"aria-hidden":"true",colSpan:y.columnCount,css:{height:"var(--nextui--tableBodyEmptySpaceHeight)"},style:o({"--nextui--tableBodyEmptySpaceHeight":I?"var(--nextui-space-10)":`calc(${L-l} * var(--nextui-space-15))`},(null==w?void 0:w.style)||{})})})}),[y.columnCount,U,L,I]);return h(a,{as:"tbody",className:r("nextui-table-body",w.className),css:{position:"relative",...w.css,...null==(H=y.body)||null==(P=H.props)?void 0:P.css},isInfinityScroll:I,onScroll:l=>{if(!I)return;const e=l.target;var o,t;e.scrollHeight-(e.scrollTop+40)<=e.clientHeight&&!T&&(null==(o=y.body)||null==(t=o.props)||null==t.onLoadMore||t.onLoadMore())},...w,children:[b,null==U?void 0:U.map((l=>l.hasChildNodes?p(s,{"aria-hidden":"false",item:l,state:f,children:[...l.childNodes].map((l=>{var e;return null!=l&&null!=(e=l.props)&&e.isSelectionCell?p(d,{animated:g,cell:l,color:x,state:f},null==l?void 0:l.key):p(c,{cell:l,isStatic:N,state:f},null==l?void 0:l.key)}))},null==l?void 0:l.key):null)),!S&&T&&p(n,{"aria-hidden":"true",className:"nextui-table-hidden-row",isAbsolute:!I,isAtEnd:U.length>0,role:"row",children:p(i,{"aria-hidden":"true",colSpan:y.columnCount,children:p(t,{color:x})})}),$]})};b.displayName="NextUI.TableBody",b.toString=()=>".nextui-table-body";export default b;