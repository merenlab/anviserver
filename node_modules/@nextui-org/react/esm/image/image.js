import t,{useEffect as e,useMemo as r,useState as o}from"react";import a from"../use-real-shape";import i from"../use-current-state";import s from"../use-resize";import{useDOMRef as m}from"../utils/dom";import{__DEV__ as n}from"../utils/assertion";import c from"../utils/clsx";import{StyledImage as u,StyledImageContainer as l}from"./image.styles";import p from"./image.skeleton";import{jsx as f}from"react/jsx-runtime";import{jsxs as d}from"react/jsx-runtime";export const Image=t.forwardRef(((t,n)=>{const{src:g,width:h,height:x,showSkeleton:w=!0,className:y,maxDelay:j=3e3,autoResize:I=!1,objectFit:N="scale-down",containerCss:b,css:T,...$}=t,k=m(n),[z,F]=o(!0),[R,S]=o(w),{w:C,h:D}=r((()=>({w:h?"number"==typeof h?`${h}px`:h:"auto",h:x?"number"==typeof x?`${x}px`:x:"auto"})),[h,x]),[L,U,q]=i(D),[v,A]=a(k),B=w&&!!h&&!!x;e((()=>{k.current&&k.current.complete&&(F(!1),S(!1))})),e((()=>{const t=setTimeout((()=>{B&&S(!1),clearTimeout(t)}),j);return()=>clearTimeout(t)}),[z]),e((()=>{if(!I)return;const t=0===v.width,e="auto"===q.current;!t&&h&&x&&(v.width<h?!e&&U("auto"):e&&U(D))}),[v,h]),s((()=>{I&&A()}));const E=r((()=>z?"loading":"ready"),[z]);return d(l,{className:c("nextui-image-container",`nextui-image--${E}`,y),css:{width:C,height:L,...b},"data-state":E,ready:!z||R,children:[R&&f(p,{opacity:1}),f(u,{ref:k,alt:t.alt||"",className:"nextui-image",css:{objectFit:N,...T},"data-state":E,height:x,src:g,width:h,onLoad:()=>{F(!1)},...$})]})}));n&&(Image.displayName="NextUI.Image"),Image.toString=()=>".nextui-image";export default t.memo(Image);