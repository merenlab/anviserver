import{useRef as e,useMemo as s,useState as o,useCallback as r}from"react";import{mergeProps as t}from"@react-aria/utils";import{useOverlayPosition as l,useOverlayTrigger as i}from"@react-aria/overlays";import{useOverlayTriggerState as n}from"@react-stately/overlays";import{mergeRefs as a}from"../utils/refs";import{isObject as p}from"../utils/object";import{getAriaPlacement as d}from"./utils";export function usePopover(u={}){const{ref:m,triggerRef:c,scrollRef:f,isOpen:g,defaultOpen:O,onOpenChange:y,isBordered:b,borderWeight:h,disableShadow:P,shouldFlip:v=!0,offset:C=12,placement:R="bottom",onClose:D,triggerType:x="dialog",isDismissable:B=!0,shouldCloseOnBlur:j=!1,isKeyboardDismissDisabled:E=!1,disableAnimation:k=!1,shouldCloseOnInteractOutside:w}=u,A=e(null),F=e(null),I=m||A,K=c||F,S=n({isOpen:g,defaultOpen:O,onOpenChange:y}),[T,W]=o(!S.isOpen),H=s((()=>S.isOpen?"open":"closed"),[S.isOpen]),q=r((()=>{null==D||D(),S.close()}),[S,D]),z=r((()=>{W(!1)}),[]),G=r((()=>{W(!0)}),[]),{triggerProps:J,overlayProps:L}=i({type:x},S,K),M=s((()=>d(R)),[R]),{overlayProps:N}=l({isOpen:S.isOpen,targetRef:K,scrollRef:f,placement:M,overlayRef:I,shouldFlip:v,offset:C}),Q=s((()=>{var e;return!(null==(e=N.style)||!e.maxHeight)}),[N.style]),U=r(((e={},s=null)=>({...null!=c&&c.current?t(J,e):t(e,J),ref:a(K,s)})),[K,c,J]),V=r(((e={},s={})=>{const o=N.style?Object.keys(N.style):[];let r={};o.forEach((e=>{const o=p(s)&&s[e];o&&(r={...r,[e]:o})}));const t=Object.keys(r).length>0?{...N,style:{...N.style,...r}}:N;return{css:s,...e,...L,...t,"data-state":H,"data-placement":R}}),[H,N,L,R]);return{state:S,exited:T,overlayRef:I,triggerRef:K,placement:R,disableShadow:P,disableAnimation:k,shouldCloseOnBlur:j,isDismissable:B,isBordered:b,borderWeight:h,isKeyboardDismissDisabled:E,shouldCloseOnInteractOutside:w,isOpen:S.isOpen,onClose:q,onExited:G,onEntered:z,triggerProps:J,overlayProps:L,positionProps:N,getTriggerProps:U,getPopoverProps:V,isPositioned:Q}}